<!DOCTYPE html>
<html>
  <head>
    <title>Marking Attendance</title>
    <script>
      window.onload = async function () {
        try {
          const ua = navigator.userAgent;

          // Fetch IP address from external API
          const ipResponse = await fetch('https://api.ipify.org?format=json');
          const ipData = await ipResponse.json();
          const ip = ipData.ip;

          // ‚úÖ Replace this with your actual Apps Script Web App URL
          const scriptURL = 'https://script.google.com/macros/s/AKfycbyGQSNk3z5bTj9uOUTmOSehPkKDjAHbMGpmmJjjiYzMfIvpX2Xgz6KoABne9MJ0ZiSEaQ/exec';

          // Final redirect to Apps Script with params
          const finalURL = `${scriptURL}?ua=${encodeURIComponent(ua)}&ip=${ip}`;

          // Redirect to trigger the logging
          window.location.href = finalURL;

        } catch (err) {
          console.error(err);
          document.body.innerHTML = "<h3>‚ùå Error submitting attendance</h3><p>" + err + "</p>";
        }
      };
    </script>
  </head>
  <body>
    <h2>üîÑ Marking your attendance...</h2>
    <p>Hang tight. This will redirect automatically.</p>
  </body>
</html>
